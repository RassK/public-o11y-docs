<nav class="navbar fixed-top navbar-expand-xl navbar-dark bg-dark" aria-label="Third navbar example">
  <div class="container-fluid">
    <a class="navbar-brand" href="https://docs.splunk.com/Observability/">
      <span class="logo-span"><img class="logoimage" src="{{ pathto('_static/splunk-logo-white.svg', 1) }}" alt="Splunk Observability Cloud Documentation" title="Splunk Observability Cloud Documentation" /></span>
      <span class="observability-label">Observability</span>
    </a>
    <button class="navbar-toggler collapsed" style="margin-bottom: 10px;" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample03" aria-controls="navbarsExample03" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="navbar-collapse collapse" id="navbarsExample03" >
      <div id="searchbox">
        <div class="searchbox-spacer"></div>
      </div>
      <style>

        .sui-search-box{
          height:36px !important;
        }

        .sui-search-box__text-input{
          border-radius: 20px 0 0 20px !important;
          min-height: 0;
        }

        .sui-search-button__label{
          display:none;
        }

        #sui-search-box__input-wrapper svg{
          display:none;
        }

        .css-gq60fg .sui-search-box__submit:disabled svg{
          fill: #212529 !important;
        }

        .css-gq60fg .sui-search-box__submit{
          max-height: 36px !important;
          width: 65px !important;
          margin-left: 0 !important;
          border-radius: 0 20px 20px 0 !important;
          background: #41AAD8;
        }

        .searchbox-spacer{
          width:100%;
          padding-left:250px;
        }
        #mobileSideBar {
          display: none;
        }

        #mainTopNavBar {
          display: block;
        }

        #mobiletopnavbar {
          display: none;
        }

        #topnavbar {
          display: none;
        }

        @media screen and (min-width: 280px) and  (max-width: 1024px) {
          #mobileSideBar {
            height: 100vh;
            overflow-y: auto;
            border-radius: 10px;
            margin-top: 10px;
            display: block;
          }

          #mainTOC {
            display: none;
          }

          #mainTopNavBar {
            display: none;
          }

          #mobiletopnavbar {
            display: block;
            text-align: center;
          }

        }
      </style>

      <div id="mainTopNavBar">
      <ul class="navbar-nav mb-2 mb-sm-0" style="margin-left: auto !important;">
         <li class="nav-item">
            <a href="https://docs.splunk.com/observability/en/get-started/service-description.html" class="nav-link newnavbar active" aria-current="page" style="margin-top:10px;">Service description</a>
         </li>
        <li class="nav-item">
          <a href="https://dev.splunk.com/observability/" class="nav-link newnavbar active" aria-current="page" target="_blank" style="margin-top:10px;">API docs</a>
        </li>
        <li class="nav-item">
          <a class="nav-link newnavbar" href="https://www.splunk.com/en_us/blog/devops.html" target="_blank">Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link newnavbar" href="https://www.splunk.com/en_us/training/course-catalog.html?sort=Newest&filters=filterGroup4SplunkObservabilityCloud%2CfilterGroup4SplunkSyntheticMonitoring%2CfilterGroup4SplunkInfrastructureMonitoring%2CfilterGroup4SplunkITSI%2CfilterGroup4SplunkAPM%2CfilterGroup4SplunkOnCall%2CfilterGroup4SplunkRUM%2CfilterGroup4SplunkLogObserver%2CfilterGroup4SplunkInsights" target="_blank">Training</a>
        </li>
        <li class="nav-item nav-lang">
          <span class="lang" data-lang="en">EN</span> | <span class="lang" data-lang="ja">JA</span>
        </li>
        <li class="nav-item">
          <a class="nav-link newnavbar" href="https://www.splunk.com/en_us/download/infrastructure-monitoring.html" target="_blank" style="
          font-size: 12px;
          border-radius: 50px;
          letter-spacing: 1px;
          padding: 10px 35px;
          text-transform: uppercase;
          color:#3E4349 !important;background-color:#DDDDDD;
          white-space: nowrap;
          margin-left: 28px;
          ">Free Trial</a>
        </li>

      </ul>
      </div>

      <style>
        .nav-lang{
          margin-top: 18px;
          color:darkgrey;
        }
        .active-lang {
          font-weight: bold;
          color: white !important;
        }
        .lang{
          cursor:pointer;
        }
      </style>
      <script>
        $(document).ready(function() {
          function setActiveLanguage() {
            var path = window.location.pathname;
            $('.lang').each(function() {
              var lang = $(this).data('lang');
              if (path.includes('/' + lang + '/')) {
                $(this).addClass('active-lang').css({
                  "font-weight": "bold",
                  "color": "red"
                });
                updateLinks(lang);
              } else {
                $(this).removeClass('active-lang').removeAttr('style');
              }
            });
          }

          function constructNewPath(lang) {
            var currentPath = window.location.pathname;
            var pathSegments = currentPath.split('/');
            var langIndex = pathSegments.findIndex(segment => $('.lang').map(function() { return $(this).data('lang'); }).get().includes(segment));

            if (langIndex > -1) {
              pathSegments[langIndex] = lang;
            } else {
              pathSegments.splice(1, 0, lang);
            }

            return pathSegments.join('/');
          }

          function updateLinks(lang) {
            var currentPath = window.location.pathname;
            var lang = "en";
            if(currentPath.includes('/ja/')) {
              lang = "ja";
            }

            $("a.nav-link.newnavbar").each(function() {
              var href = $(this).attr("href");
              if(href && (href.includes('observability/en/') || href.includes('Observability/en/'))) {
                $(this).attr("href", href.replace('observability/en/', 'observability/' + lang + '/'));
              }
            });
          }

          $('.lang').click(function() {
            var lang = $(this).data('lang');
            var newPath = constructNewPath(lang);
            window.location.pathname = newPath;

            setActiveLanguage();
          });

          setActiveLanguage();
        });
      </script>

      <div id="mobileSideBar">
        {%- block sidebar2 %}{{ sidebar() }}{% endblock %}
      </div>
        <div class="clearer"></div>

    </div>
  </div>
</nav>

